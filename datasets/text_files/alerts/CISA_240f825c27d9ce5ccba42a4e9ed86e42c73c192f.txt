BadAlloc Vulnerability Affecting BlackBerry QNX RTOS | CISA Skip to main content An official website of the United States government Here's how you know Official websites use .gov A .gov website belongs to an official government organization in the United States. Secure .gov websites use HTTPS A lock ( ) or https:// means you've safely connected to the .gov website. Share sensitive information only on official, secure websites. CISA.gov Services Report Toggle navigation CISA.gov Services Report CertMain Menu Alerts and Tips Resources Industrial Control Systems TLP:WHITE TLP:WHITE National Cyber Awareness System > Alerts > BadAlloc Vulnerability Affecting BlackBerry QNX RTOS More Alerts Alert (AA21-229A) BadAlloc Vulnerability Affecting BlackBerry QNX RTOS Original release date: August 17, 2021  | Last revised : August 23, 2021 Summary On August 17, 2021, BlackBerry publicly disclosed that its QNX Real Time Operating System (RTOS) is affected by a BadAlloc vulnerability—CVE-2021-22156. BadAlloc is a collection of vulnerabilities affecting multiple RTOSs and supporting libraries.[ 1 ] A remote attacker could exploit CVE-2021-22156 to cause a denial-of-service condition or execute arbitrary code on affected devices.[ 2 ] BlackBerry QNX RTOS is used in a wide range of products whose compromise could result in a malicious actor gaining control of highly sensitive systems,  increasing risk to the Nation’s critical functions. Note : at this time, CISA is not aware of active exploitation of this vulnerability. CISA strongly encourages critical infrastructure organizations and other organization developing, maintaining, supporting, or using affected QNX-based systems, to patch affected products as quickly as possible. Refer to the Mitigations section for more information about patching. Click here for a PDF version of this report. Technical Details CVE-2021-22156 is an integer overflow vulnerability affecting the calloc() function in the C runtime library of multiple BlackBerry QNX products. Exploitation of this vulnerability could lead to a denial-of-service condition or arbitrary code execution in affected devices. To exploit this vulnerability, an attacker must have control over the parameters to a calloc() function call and the ability to control what memory is accessed after the allocation. An attacker with network access could remotely exploit this vulnerability if the vulnerable product is running and the affected device is exposed to the internet.[ 3 ] CVE-2021-22156 is part of a collection of integer overflow vulnerabilities, known as BadAlloc, which affect a wide range of industries using Internet of Things (IoT), and operational technology (OT)/industrial control systems (ICS) devices. See CISA ICS Advisory ICSA-21-119-04 and Microsoft’s BadAlloc blog post for more information. All BlackBerry programs with dependency on the C runtime library are affected by this vulnerability (see table 1 for a list of affected BlackBerry QNX products). Because many affected devices include safety-critical devices, exploitation of this vulnerability could result in a malicious actor gaining control of sensitive systems, possibly leading to increased risk of damage to infrastructure or critical functions. Table 1: Affected BlackBerry QNX Products [ 4 ] Product Affected Version QNX SDP 6.5.0SP1, 6.5.0,  6.4.1, 6.4.0 QNX Momentics Development Suite 6.3.2 QNX Momentics 6.3.0SP3, 6.3.0SP2, 6.3.0SP1, 6.3.0, 6.2.1b, 6.2.1, 6.2.1A, 6.2.0 QNX Realtime Platform 6.1.0a, 6.1.0, 6.0.0a, 6.0.0 QNX Cross Development Kit 6.0.0, 6.1.0 QNX Development Kit (Self-hosted) 6.0.0, 6.1.0 QNX Neutrino RTOS Safe Kernel 1.0 QNX Neutrino RTOS Certified Plus 1.0 QNX Neutrino RTOS for Medical Devices 1.0, 1.1 QNX OS for Automotive Safety 1.0 QNX OS for Safety 1.0, 1.0.1 QNX Neutrino Secure Kernel 6.4.0, 6.5.0 QNX CAR Development Platform 2.0RR Mitigations CISA strongly encourages critical infrastructure organizations and other organizations developing, maintaining, supporting, or using affected QNX-based systems to patch affected products as quickly as possible. Manufacturers of products that incorporate vulnerable versions should contact BlackBerry to obtain the patch. Manufacturers of products who develop unique versions of RTOS software should contact BlackBerry to obtain the patch code. Note: in some cases, manufacturers may need to develop and test their own software patches. End users of safety-critical systems should contact the manufacturer of their product to obtain a patch. If a patch is available, users should apply the patch as soon as possible. If a patch is not available, users should apply the manufacturer's recommended mitigation measures until the patch can be applied. Note : installation of software updates for RTOS frequently may require taking the device out of service or to an off-site location for physical replacement of integrated memory. Critical infrastructure organizations are encouraged to review the following guidance for additional information: U.S. Coast Guard Maritime Security Advisory: Maritime Cyber Alert 02-21 U.S. Nuclear Regulatory Commission Security Advisory: Blackberry QNX Vulnerability Joint WaterISAC: U.S. Environmental Protection Agency Advisory - BadAlloc Vulnerability Impacting BlackBerry QNX RTOS Resources CISA ICS Advisory: ICSA-21-119-04: Multiple RTOS BlackBerry: QNX-2021-001 Vulnerability in the C Runtime Library Impacts BlackBerry QNX Software Development Platform (SDP), QNX OS for Medical, and QNX OS for Safety References [1] BlackBerry: QNX-2021-001 Vulnerability in the C Runtime Library Impacts Bla… [2] Ibid. [3] Ibid. [4] BlackBerry: QNX. Affected Product List Revisions Initial version: August 17, 2021 August 18, 2021: Added links to U.S. Coast Guard and U.S. Nuclear Regulatory Commission advisories. August 23, 2021: Added additional resource for critical infrastructure organizations This product is provided subject to this Notification and this Privacy & Use policy. Please share your thoughts. We recently updated our anonymous product survey ; we'd welcome your feedback. Contact Us (888)282-0870 Send us email Download PGP/GPG keys Submit website feedback Subscribe to Alerts Receive security alerts, tips, and other updates. Enter your email address HSIN Report Home Site Map FAQ Contact Us Traffic Light Protocol PCII Accountability Disclaimer Privacy Policy FOIA No Fear Act Accessibility Plain Writing Plug-ins Inspector General The White House USA.gov CISA is part of the Department of Homeland Security