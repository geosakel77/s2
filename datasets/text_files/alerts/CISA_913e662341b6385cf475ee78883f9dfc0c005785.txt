Microsoft Windows ANI Header Stack Buffer Overflow | CISA Skip to main content An official website of the United States government Here's how you know Official websites use .gov A .gov website belongs to an official government organization in the United States. Secure .gov websites use HTTPS A lock ( ) or https:// means you've safely connected to the .gov website. Share sensitive information only on official, secure websites. CISA.gov Services Report Toggle navigation CISA.gov Services Report CertMain Menu Alerts and Tips Resources Industrial Control Systems TLP:WHITE TLP:WHITE National Cyber Awareness System > Archives Alerts > Microsoft Windows ANI Header Stack Buffer Overflow This document is part of the US-CERT website archive. These documents are no longer updated and may contain outdated information. Links may also no longer function. Please contact info@us-cert.gov if you have any questions about the US-CERT website archive. More Alerts Alert (TA07-089A) Microsoft Windows ANI Header Stack Buffer Overflow Original release date: March 30, 2007  | Last revised : April 03, 2007 Systems Affected Microsoft Windows 2000, XP, Server 2003, and Vista are affected. Applications that provide attack vectors include Microsoft Internet Explorer Microsoft Outlook Microsoft Outlook Express Microsoft Windows Mail Microsoft Windows Explorer Overview A buffer overflow vulnerability in the way Microsoft Windows handles animated cursor files is actively being exploited. For updated solution information, see US-CERT Technical Cyber Security Alert TA07-093A and Microsoft Security Bulletin MS07-017 . Description A stack buffer overflow exists in the code that Microsoft Windows
uses to process animated cursor files. Specifically, Windows fails to properly validate the size of an animated cursor file header supplied in 
animated cursor files. Animated cursor files can be included with HTML files. For instance, a
web site can use an animated cursor file to specify the icon that the
mouse pointer should use when hovering over a hyperlink. Because of
this, malicious web pages and HTML email messages can be used to exploit
this vulnerability. In addition, animated cursor files are
automatically parsed by Windows Explorer when the containing folder is
opened or the file is used as a cursor. Consequently, opening a folder
that contains a specially crafted animated cursor file will also
trigger this vulnerability. Note that Windows Explorer will process animated cursor files with several
different file extensions, such as .ani , .cur , or .ico . Furthermore,
Windows will automatically render animated cursor files referenced by HTML documents
regardless of the animated cursor file extension. This vulnerability is actively being exploited. More information is available in Vulnerability Note VU#191609 . Impact A remote, unauthenticated attacker may be able to execute arbitrary code. Exploitation may occur when a user clicks a malicious link, reads or forwards a specially crafted HTML email, or accesses a folder containing a malicious animated cursor file. Solution Install updates from Microsoft Microsoft has released updates for this and other image processing vulnerabilities in Microsoft Security Bulletin MS07-017 . Workarounds Until updates can be installed, refer to the Solution section of Vulnerability Note VU#191609 for the latest workarounds. References US-CERT Technical Cyber Security Alert TA07-093A - http://www.us-cert.gov/cas/techalerts/TA07-093A.html Vulnerability Note VU#191609 - http://www.kb.cert.org/vuls/id/191609 Microsoft Security Bulletin MS07-017 - http://www.microsoft.com/technet/security/Bulletin/ms07-017.mspx Microsoft Security Advisory (935423) - http://www.microsoft.com/technet/security/advisory/935423.mspx Microsoft Security Response Center Blog - http://blogs.technet.com/msrc/search.aspx?q=935423 Unpatched Drive-By Exploit Found On The Web - http://www.avertlabs.com/research/blog/?p=230 TROJ_ANICHMOO.AX - Description and Solution - http://www.trendmicro.com/vinfo/virusencyclo/default5.asp?VName=TROJ%5FANICMOO%2EAX Revision History March 30, 2007:  Initial release April 03, 2007:  Updated with release of MS07-017.  Title changed, previous title was "Microsoft Windows ANI header stack buffer overflow." This product is provided subject to this Notification and this Privacy & Use policy. Please share your thoughts. We recently updated our anonymous product survey ; we'd welcome your feedback. Contact Us (888)282-0870 Send us email Download PGP/GPG keys Submit website feedback Subscribe to Alerts Receive security alerts, tips, and other updates. Enter your email address HSIN Report Home Site Map FAQ Contact Us Traffic Light Protocol PCII Accountability Disclaimer Privacy Policy FOIA No Fear Act Accessibility Plain Writing Plug-ins Inspector General The White House USA.gov CISA is part of the Department of Homeland Security