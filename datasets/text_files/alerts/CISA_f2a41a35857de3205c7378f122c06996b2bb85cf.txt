Sourcefire Snort DCE/RPC Preprocessor Buffer Overflow | CISA Skip to main content An official website of the United States government Here's how you know Official websites use .gov A .gov website belongs to an official government organization in the United States. Secure .gov websites use HTTPS A lock ( ) or https:// means you've safely connected to the .gov website. Share sensitive information only on official, secure websites. CISA.gov Services Report Toggle navigation CISA.gov Services Report CertMain Menu Alerts and Tips Resources Industrial Control Systems TLP:WHITE TLP:WHITE National Cyber Awareness System > Archives Alerts > Sourcefire Snort DCE/RPC Preprocessor Buffer Overflow This document is part of the US-CERT website archive. These documents are no longer updated and may contain outdated information. Links may also no longer function. Please contact info@us-cert.gov if you have any questions about the US-CERT website archive. More Alerts Alert (TA07-050A) Sourcefire Snort DCE/RPC Preprocessor Buffer Overflow Original release date: February 19, 2007 Systems Affected Snort 2.6.1, 2.6.1.1, and 2.6.1.2 Snort 2.7.0 beta 1 Sourcefire Intrusion Sensors version 4.1.x, 4.5.x, and 4.6x with SEUs prior to SEU 64 Sourcefire Intrusion Sensors for Crossbeam version 4.1.x, 4.5.x, and 4.6x with SEUs prior to SEU 64 Other products that use Snort or Snort components may be affected. Overview A stack buffer overflow vulnerability in the Sourcefire Snort DCE/RPC preprocessor could allow an unauthenticated, remote attacker to execute arbitrary code with the privileges of the Snort process. Description Sourcefire Snort is a widely-deployed, open-source network intrusion detection system (IDS). Snort and its components are used in other IDS products, notably Sourcefire, and Snort is included with a number of operating system distributions.  The DCE/RPC preprocessor reassembles fragmented SMB and DCE/RPC traffic before passing data to the Snort rules. The vulnerable code does not properly reassemble certain types of SMB and DCE/RPC packets.  An attacker could exploit this vulnerability by sending a specially crafted TCP packet to a host or network monitored by Snort.  The DCE/RPC preprocessor is enabled by default, and it is not necessary for an attacker to complete a TCP handshake. US-CERT is tracking this vulnerability as VU#196240 . This vulnerability has been assigned CVE number CVE-2006-5276 . Further information is available in advisories from Sourcefire and ISS . Impact A remote, unauthenticated attacker may be able to execute arbitrary code with the privilege level of the Snort preprocessor. Solution Upgrade Snort 2.6.1.3 is available from the Snort download site.  Sourcefire customers should visit the Sourcefire Support Login site. Disable the DCE/RPC Preprocessor To disable the DCE/RPC preprocessor, comment out the line that loads the preprocessor in the Snort configuration file (typically /etc/snort.conf on UNIX and Linux systems): [/etc/snort.conf] ... #preprocessor dcerpc... ... Restart Snort for the change to take effect. Disabling the preprocessor will prevent Snort from reassembling fragmented SMB and DCE/RPC packets.  This may allow attacks to evade the IDS. References US-CERT Vulnerability Note VU#196240 - http://www.kb.cert.org/vuls/id/196240 Sourcefire Advisory 2007-02-19 - http://www.snort.org/docs/advisory-2007-02-19.html Sourcefire Support Login - https://support.sourcefire.com/ Sourcefire Snort Release Notes for 2.6.1.3 - http://www.snort.org/docs/release_notes/release_notes_2613.txt Snort downloads - http://www.snort.org/dl/ DCE/RPC Preprocessor - http://www.snort.org/docs/snort_htmanuals/htmanual_261/node104.html IBM Internet Security Systems Protection Advisory - http://iss.net/threats/257.html CVE-2006-5276 - http://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-5276 Revision History February 19, 2007:  Initial release This product is provided subject to this Notification and this Privacy & Use policy. Please share your thoughts. We recently updated our anonymous product survey ; we'd welcome your feedback. Contact Us (888)282-0870 Send us email Download PGP/GPG keys Submit website feedback Subscribe to Alerts Receive security alerts, tips, and other updates. Enter your email address HSIN Report Home Site Map FAQ Contact Us Traffic Light Protocol PCII Accountability Disclaimer Privacy Policy FOIA No Fear Act Accessibility Plain Writing Plug-ins Inspector General The White House USA.gov CISA is part of the Department of Homeland Security