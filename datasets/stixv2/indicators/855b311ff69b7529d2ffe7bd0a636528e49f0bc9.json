{
    "type": "indicator",
    "spec_version": "2.1",
    "id": "indicator--28143aeb-b293-4931-b174-8c621f292b8a",
    "created": "2017-08-23T14:11:13.000Z",
    "modified": "2017-08-23T14:11:13.000Z",
    "name": "OTX pulse_name=Regin",
    "description": "",
    "pattern": "rule Regin_APT_KernelDriver_Generic_B    \n   {   \n      \n       meta:   \n           description = \"Generic rule for Regin APT kernel driver Malware - Symantec http://t.co/qu53359Cb2\"   \n           author = \"@Malwrsignatures - included in APT Scanner THOR\"   \n           date = \"23.11.14\"   \n           hash1 = \"ffb0b9b5b610191051a7bdf0806e1e47\"   \n           hash2 = \"bfbe8c3ee78750c3a520480700e440f8\"   \n           hash3 = \"b29ca4f22ae7b7b25f79c1d4a421139d\"   \n           hash4 = \"06665b96e293b23acc80451abb413e50\"   \n           hash5 = \"2c8b9d2885543d7ade3cae98225e263b\"   \n           hash6 = \"4b6b86c7fec1c574706cecedf44abded\"   \n           hash7 = \"187044596bc1328efa0ed636d8aa4a5c\"   \n           hash8 = \"d240f06e98c8d3e647cbf4d442d79475\"   \n           hash9 = \"6662c390b2bbbd291ec7987388fc75d7\"   \n           hash10 = \"1c024e599ac055312a4ab75b3950040a\"   \n           hash11 = \"ba7bb65634ce1e30c1e5415be3d1db1d\"   \n           hash12 = \"b505d65721bb2453d5039a389113b566\"   \n           hash13 = \"b269894f434657db2b15949641a67532\"   \n      \n       strings:   \n           $m0 = { 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8 }    \n           $s1 = { 0e 1f ba 0e 00 b4 09 cd 21 b8 01 4c cd 21 54 68 69 73 20 70 72 6f 67 72 61 6d 20 63 61 6e 6e 6f 74 20 62 65 20 72 75 6e 20 69 6e 20 44 4f 53 20 6d 6f 64 65 2e }   \n           $s2 = \"H.data\" fullword ascii nocase   \n           $s3 = \"INIT\" fullword ascii   \n           $s4 = \"ntoskrnl.exe\" fullword ascii   \n           $v1 = \"\\\\system32\" fullword ascii   \n           $v2 = \"\\\\SystemRoot\" fullword ascii   \n           $v3 = \"KeServiceDescriptorTable\" fullword ascii    \n           $w1 = \"\\\\system32\" fullword ascii   \n           $w2 = \"\\\\SystemRoot\" fullword ascii        \n           $w3 = \"LRich6\" fullword ascii           \n           $x1 = \"_snprintf\" fullword ascii   \n           $x2 = \"_except_handler3\" fullword ascii   \n           $y1 = \"mbstowcs\" fullword ascii   \n           $y2 = \"wcstombs\" fullword ascii   \n           $y3 = \"KeGetCurrentIrql\" fullword ascii   \n           $z1 = \"wcscpy\" fullword ascii   \n           $z2 = \"ZwCreateFile\" fullword ascii   \n           $z3 = \"ZwQueryInformationFile\" fullword ascii   \n           $z4 = \"wcslen\" fullword ascii   \n           $z5 = \"atoi\" fullword ascii   \n         \n       condition:   \n           $m0 at 0 and all of ($s*) and ( all of ($v*) or all of ($w*) or all of ($x*) or all of ($y*) or all of ($z*) ) and filesize < 20KB   \n   }",
    "pattern_type": "yara",
    "valid_from": "2017-08-23T14:11:13Z"
}